<%- include('../layout/adminLayouts/header') -%>


    <body>
        <div class="container-fluid position-relative d-flex p-0">
            <!-- Spinner Start -->
            <div id="spinner"
                class="show bg-dark position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
                <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
            <!-- Spinner End -->
            <%- include('../layout/adminLayouts/sidebar') -%>
                <!-- Content Start -->
                <div class="content">
                    <!-- Navbar Start -->
                    <nav class="navbar navbar-expand bg-secondary navbar-dark sticky-top px-4 py-0">
                        <a href="index.html" class="navbar-brand d-flex d-lg-none me-4">
                            <h2 class="text-primary mb-0"><i class="fa fa-user-edit"></i></h2>
                        </a>
                        <a href="#" class="sidebar-toggler flex-shrink-0">
                            <i class="fa fa-bars"></i>
                        </a>
                        <form class="d-none d-md-flex ms-4">
                            <input class="form-control bg-dark border-0" type="search" placeholder="Search">
                        </form>
                        <div class="navbar-nav align-items-center ms-auto">
                            <!-- <div class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                                <i class="fa fa-envelope me-lg-2"></i>
                                <span class="d-none d-lg-inline-flex">Message</span>
                            </a>
                            <div
                                class="dropdown-menu dropdown-menu-end bg-secondary border-0 rounded-0 rounded-bottom m-0">
                                <a href="#" class="dropdown-item">
                                    <div class="d-flex align-items-center">
                                        <img class="rounded-circle" src="adminAssets/img/user.jpg" alt=""
                                            style="width: 40px; height: 40px;">
                                        <div class="ms-2">
                                            <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                            <small>15 minutes ago</small>
                                        </div>
                                    </div>
                                </a>
                                <hr class="dropdown-divider">
                                <a href="#" class="dropdown-item">
                                    <div class="d-flex align-items-center">
                                        <img class="rounded-circle" src="adminAssets/img/user.jpg" alt=""
                                            style="width: 40px; height: 40px;">
                                        <div class="ms-2">
                                            <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                            <small>15 minutes ago</small>
                                        </div>
                                    </div>
                                </a>
                                <hr class="dropdown-divider">
                                <a href="#" class="dropdown-item">
                                    <div class="d-flex align-items-center">
                                        <img class="rounded-circle" src="adminAssets/img/user.jpg" alt=""
                                            style="width: 40px; height: 40px;">
                                        <div class="ms-2">
                                            <h6 class="fw-normal mb-0">Jhon send you a message</h6>
                                            <small>15 minutes ago</small>
                                        </div>
                                    </div>
                                </a>
                                <hr class="dropdown-divider">
                                <a href="#" class="dropdown-item text-center">See all message</a>
                            </div>
                        </div> -->
                            <!-- <div class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                                <i class="fa fa-bell me-lg-2"></i>
                                <span class="d-none d-lg-inline-flex">Notification</span>
                            </a>
                            <div
                                class="dropdown-menu dropdown-menu-end bg-secondary border-0 rounded-0 rounded-bottom m-0">
                                <a href="#" class="dropdown-item">
                                    <h6 class="fw-normal mb-0">Profile updated</h6>
                                    <small>15 minutes ago</small>
                                </a>
                                <hr class="dropdown-divider">
                                <a href="#" class="dropdown-item">
                                    <h6 class="fw-normal mb-0">New user added</h6>
                                    <small>15 minutes ago</small>
                                </a>
                                <hr class="dropdown-divider">
                                <a href="#" class="dropdown-item">
                                    <h6 class="fw-normal mb-0">Password changed</h6>
                                    <small>15 minutes ago</small>
                                </a>
                                <hr class="dropdown-divider">
                                <a href="#" class="dropdown-item text-center">See all notifications</a>
                            </div>
                        </div> -->
                            <div class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                                    <img class="rounded-circle me-lg-2" src="/adminAssets/img/user.jpg" alt=""
                                        style="width: 40px; height: 40px;">
                                    <span class="d-none d-lg-inline-flex">Sanjay k</span>
                                </a>
                                <div
                                    class="dropdown-menu dropdown-menu-end bg-secondary border-0 rounded-0 rounded-bottom m-0">
                                    <a href="#" class="dropdown-item">My Profile</a>
                                    <a href="#" class="dropdown-item">Settings</a>
                                    <a href="/admin/logout" class="dropdown-item">Log Out</a>
                                </div>
                            </div>
                        </div>
                    </nav>
                    <!-- Navbar End -->


                    <!-- Sale & Revenue Start -->
                    <div class="container-fluid pt-4 px-4">
                        <div class="row g-4">
                            <div class="col-sm-6 col-xl-3">
                                <div class="bg-secondary rounded d-flex align-items-center justify-content-between p-4">
                                    <i class="fa fa-chart-line fa-3x text-primary"></i>
                                    <div class="ms-3">
                                        <p class="mb-2">Revenue</p>
                                        <h6 class="mb-0">â‚¹ <%= totalRevenue %>
                                        </h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-xl-3">
                                <div class="bg-secondary rounded d-flex align-items-center justify-content-between p-4">
                                    <i class="fa fa-chart-bar fa-3x text-primary"></i>
                                    <div class="ms-3">
                                        <p class="mb-2">Orders</p>
                                        <h6 class="mb-0">
                                            <%= ordersCount %>
                                        </h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-xl-3">
                                <div class="bg-secondary rounded d-flex align-items-center justify-content-between p-4">
                                    <i class="fa fa-chart-area fa-3x text-primary"></i>
                                    <div class="ms-3">
                                        <p class="mb-2">Products</p>
                                        <h6 class="mb-0">
                                            <%= productsCount %>

                                        </h6>

                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-xl-3">
                                <div class="bg-secondary rounded d-flex align-items-center justify-content-between p-4">
                                    <i class="fa fa-chart-area fa-3x text-primary"></i>
                                    <div class="ms-3">
                                        <p class="mb-2">Categories</p>
                                        <h6 class="mb-0">
                                            <%= categoriesCount %>

                                        </h6>

                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-xl-3">
                                <div class="bg-secondary rounded d-flex align-items-center justify-content-between p-4">
                                    <i class="fa fa-chart-pie fa-3x text-primary"></i>
                                    <div class="ms-3">
                                        <p class="mb-2">Monthly Earnings</p>
                                        <h6 class="mb-0">â‚¹<%=currentMonthRevenue%>
                                        </h6>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Sale & Revenue End -->


                    <!-- Sales Chart Start -->
                    <div class="container-fluid pt-4 px-4">
                        <div class="row g-4">
                            <div class="col-sm-12 col-xl-6">
                                <div class="bg-secondary text-center rounded p-4">
                                    <div class="d-flex align-items-center justify-content-between mb-4">
                                        <h6 class="mb-0">Monthly Sale Statistics</h6>
                                        <!-- <a href="">Show All</a> -->
                                    </div>
                                    <canvas id="monthly"></canvas>
                                </div>
                            </div>
                            <div class="col-sm-12 col-xl-6">
                                <div class="bg-secondary text-center rounded p-4">
                                    <div class="d-flex align-items-center justify-content-between mb-4">
                                        <h6 class="mb-0">Yearly Sale Statistics</h6>
                                        <!-- <a href="">Show All</a> -->
                                    </div>
                                    <canvas id="yearly"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Sales Chart End -->

                    <!-- Category Wise Chart Start -->
                    <div class="container-fluid pt-4 px-4">
                        <div class="row g-4">
                            <div class="col-sm-12 col-xl-6">
                                <div class="bg-secondary text-center rounded p-4">
                                    <div class="d-flex align-items-center justify-content-between mb-4">
                                        <h6 class="mb-0">Monthly Sale Statistics</h6>
                                        <!-- <a href="">Show All</a> -->
                                    </div>
                                    <canvas id="monthlyCategory"></canvas>
                                </div>
                            </div>
                            <div class="col-sm-12 col-xl-6">
                                <div class="bg-secondary text-center rounded p-4">
                                    <div class="d-flex align-items-center justify-content-between mb-4">
                                        <h6 class="mb-0">Yearly Sale Statistics</h6>
                                        <!-- <a href="">Show All</a> -->
                                    </div>
                                    <canvas id="yearlyCategory"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Category wise Chart End -->


                    <!-- New Members Start -->
                    <div class="container-fluid pt-4 px-4">
                        <div class="bg-secondary text-center rounded p-4">
                            <div class="d-flex align-items-center justify-content-between mb-4">
                                <h6 class="mb-0">New Members</h6>
                                <!-- <a href="">Show All</a> -->
                            </div>
                            <div class="table-responsive">
                                <table class="table text-start align-middle table-bordered table-hover mb-0">
                                    <thead>
                                        <tr class="text-white">
                                            <!-- <th scope="col"><input class="form-check-input" type="checkbox"></th> -->
                                            <th scope="col">Customer</th>
                                            <th scope="col">Email</th>
                                            <th scope="col">Mobile</th>
                                            <th scope="col">Joined Date</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% latestUsers.forEach(user=> { %>
                                            <tr>
                                                <td>
                                                    <%= user.username %>
                                                </td>
                                                <td>
                                                    <%= user.email %>
                                                </td>
                                                <td>
                                                    <%= user.mobile %>
                                                </td>
                                                <td>
                                                    <%= user.createdAt.toDateString() %>
                                                </td>
                                            </tr>
                                            <% }); %>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>


                    <!-- Latest Orders -->
                    <div class="container-fluid pt-4 px-4">
                        <a href="/admin/salesReport" class="btn btn-danger mt-4 mb-2 ml-auto  pull-right"> Sales
                            Report</a>
                        <div class="bg-secondary text-center rounded p-4">
                            <div class="d-flex align-items-center justify-content-between mb-4">
                                <h6 class="mb-0">Latest orders</h6>
                                <!-- <a href="">Show All</a> -->
                            </div>
                            <div class="table-responsive">
                                <table class="table text-start align-middle table-bordered table-hover mb-0">
                                    <thead>
                                        <tr class="text-white">
                                            <!-- <th scope="col"><input class="form-check-input" type="checkbox"></th> -->
                                            <th scope="col">Order ID</th>
                                            <th scope="col">Billing Name</th>
                                            <th scope="col">Date</th>
                                            <th scope="col">Total</th>
                                            <th scope="col">Order Status</th>
                                            <th scope="col">Payment Method</th>
                                            <!-- <th scope="col">View Details</th> -->
                                        </tr>
                                    </thead>
                                    <tbody>
                                    <tbody>
                                        <% latestOrders.forEach(order=> { %>
                                            <tr>
                                                <td>
                                                    <%= order.orderId %>
                                                </td>
                                                <td>
                                                    <%= order.username %>
                                                </td>
                                                <td>
                                                    <%= order.date.toDateString() %>
                                                </td>
                                                <td>
                                                    <%= order.totalAmount %>
                                                </td>
                                                <td>
                                                    <%= order.status %>
                                                </td>
                                                <td>
                                                    <%= order.payment %>
                                                </td>
                                                <!-- <td> <a class="btn btn-sm btn-primary view-details-button"
                                                        href="/admin/orderDetails?itemId=<%= order.itemId %>"
                                                        data-item-id="<%= order.itemId %>">
                                                        View Details
                                                    </a </td> -->
                                            </tr>
                                            <% }); %>
                                    </tbody>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>


                    <%- include('../layout/adminLayouts/footer') -%>


                        <script>

                        </script>


                        <script>
                            // Sale Statistics Monthly
                            var ctx2 = $("#monthly").get(0).getContext("2d");
                            var myChart2 = new Chart(ctx2, {
                                type: "line",
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                                    datasets: [
                                        {
                                            label: "Revenue",
                                            data: [<%= monthlyRevenue.map(month => month.totalRevenue) %>],
                                            backgroundColor: "rgba(255, 0, 0, 0.7)",
                                            fill: true
                                        },
                                        {
                                            label: "Orders",
                                            data: [<%= monthlyOrders.map(month => month.totalOrders) %>],
                                            backgroundColor: "rgba(255, 99, 132, 0.7)", // Lighter red for Orders
                                            fill: true
                                        },
                                        {
                                            label: "Users",
                                            data: [<%= monthlyUsers.map(month => month.totalUsers) %>],
                                            backgroundColor: "rgba(255, 150, 150, 0.7)", // Even lighter red for Users
                                            fill: true
                                        }
                                    ]
                                },
                                options: {
                                    responsive: true
                                }
                            });



                            // Sales & Revenue Chart Yearly
                            var ctx2 = $("#yearly").get(0).getContext("2d");
                            var myChart2 = new Chart(ctx2, {
                                type: "line",
                                data: {
                                    labels: ["2018", "2019", "2020", "2021", "2022", "2023", "2024"],
                                    datasets: [
                                        {
                                            label: "Revenue",
                                            data: [<%= yearlyRevenue.map(data => data.totalRevenue) %>],
                                            backgroundColor: "rgba(255, 0, 0, 0.7)", // Deeper red for Revenue
                                            fill: true
                                        },
                                        {
                                            label: "Orders",
                                            data: [<%= yearlyOrders.map(data => data.totalOrders) %>],
                                            backgroundColor: "rgba(255, 150, 150, 0.7)", // Lighter red for Orders
                                            fill: true
                                        },
                                        {
                                            label: "Users",
                                            data: [<%= yearlyUsers.map(data => data.totalUsers) %>],
                                            backgroundColor: "rgba(255, 200, 200, 0.7)", // Even lighter red for Users
                                            fill: true
                                        }
                                    ]
                                },
                                options: {
                                    responsive: true
                                }
                            });


                            // Category Wise Sale Statistics Monthly
                            var ctx2 = $("#monthlyCategory").get(0).getContext("2d");
                            var myChart2 = new Chart(ctx2, {
                                type: "line",
                                data: {
                                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                                    datasets: [
                                        {
                                            label: "MENS",
                                            data: [<%= monthlyRevenue.map(month => month.totalRevenue) %>],
                                            backgroundColor: "rgba(255, 0, 0, 0.7)",
                                            fill: true
                                        },
                                        {
                                            label: "WOMENS",
                                            data: [<%= monthlyOrders.map(month => month.totalOrders) %>],
                                            backgroundColor: "rgba(255, 99, 132, 0.7)", // Lighter red for Orders
                                            fill: true
                                        }
                                    ]
                                },
                                options: {
                                    responsive: true
                                }
                            });


                             // Category Wise Sales & Revenue Chart Yearly
                             var ctx2 = $("#yearlyCategory  ").get(0).getContext("2d");
                            var myChart2 = new Chart(ctx2, {
                                type: "line",
                                data: {
                                    labels: ["2018", "2019", "2020", "2021", "2022", "2023", "2024"],
                                    datasets: [
                                        {
                                            label: "MENS",
                                            data: [<%= yearlyRevenue.map(data => data.totalRevenue) %>],
                                            backgroundColor: "rgba(255, 0, 0, 0.7)", // Deeper red for Revenue
                                            fill: true
                                        },
                                        {
                                            label: "WOMENS",
                                            data: [<%= yearlyOrders.map(data => data.totalOrders) %>],
                                            backgroundColor: "rgba(255, 150, 150, 0.7)", // Lighter red for Orders
                                            fill: true
                                        },
                                    ]
                                },
                                options: {
                                    responsive: true
                                }
                            });


                        </script>